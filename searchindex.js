Search.setIndex({docnames:["functorch","generated/functorch.combine_state_for_ensemble","generated/functorch.grad","generated/functorch.grad_and_value","generated/functorch.hessian","generated/functorch.jacfwd","generated/functorch.jacrev","generated/functorch.jvp","generated/functorch.make_functional","generated/functorch.make_functional_with_buffers","generated/functorch.vjp","generated/functorch.vmap","index","install","notebooks/aot_autograd_optimizations","notebooks/ensembling","notebooks/jacobians_hessians","notebooks/per_sample_grads"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["functorch.rst","generated/functorch.combine_state_for_ensemble.rst","generated/functorch.grad.rst","generated/functorch.grad_and_value.rst","generated/functorch.hessian.rst","generated/functorch.jacfwd.rst","generated/functorch.jacrev.rst","generated/functorch.jvp.rst","generated/functorch.make_functional.rst","generated/functorch.make_functional_with_buffers.rst","generated/functorch.vjp.rst","generated/functorch.vmap.rst","index.rst","install.rst","notebooks/aot_autograd_optimizations.ipynb","notebooks/ensembling.ipynb","notebooks/jacobians_hessians.ipynb","notebooks/per_sample_grads.ipynb"],objects:{functorch:{combine_state_for_ensemble:[1,0,1,""],grad:[2,0,1,""],grad_and_value:[3,0,1,""],hessian:[4,0,1,""],jacfwd:[5,0,1,""],jacrev:[6,0,1,""],jvp:[7,0,1,""],make_functional:[8,0,1,""],make_functional_with_buffers:[9,0,1,""],vjp:[10,0,1,""],vmap:[11,0,1,""]}},objnames:{"0":["py","function","Python function"]},objtypes:{"0":"py:function"},terms:{"0th":[11,17],"0x7f3c860b5520":15,"0x7f3c8c061e80":15,"0x7f4461e19a60":16,"0x7f4461e1b8b0":16,"0x7f4461e30ee0":16,"0x7f4461e3ee20":16,"0x7f44629bc760":16,"0x7f4462a8b3a0":16,"0x7fecb028ef10":17,"0x7fecb028ef70":17,"100":[14,15,17],"1024":14,"1200679540634":14,"128":[15,17],"1560":14,"1696897726506":14,"1899":14,"2048":[14,16],"2249767417088":14,"2723174951971":14,"361":16,"424":16,"4606417762116":14,"500":[15,16,17],"5240693548694":14,"603":16,"6400":15,"6959593920038":14,"7003795811906":14,"712":14,"713":14,"734":14,"740":14,"7676504226401":14,"791":14,"831":14,"8530415249988":14,"909":14,"9216":[15,17],"982":14,"case":[2,6,10,12,15,16,17],"class":[1,15,17],"default":[2,3,4,5,6,7,10,11,14,15],"final":[14,16,17],"function":[1,2,3,4,5,6,7,8,9,10,11,14,15,16,17],"import":[2,4,5,6,7,8,9,14,15,16,17],"int":[2,3,4,5,6,11],"new":[0,11,17],"return":[0,1,2,3,4,5,6,7,8,9,10,11,14,15,16,17],"super":[15,17],"true":[2,3,5,6,7,10,11,14],"try":14,"while":[14,16],And:[8,9],But:17,For:[0,11,12,14,15],One:[1,11,15],That:[0,16],The:[4,7,10,11,14,15,16,17],There:[12,13,15,16,17],These:14,Use:12,Using:[2,6,10,11],With:14,__init__:[15,17],__torch_dispatch__:14,a100:[15,17],abl:[15,17],about:[12,14,15,16,17],abov:[12,14,16],acceler:14,accept:[0,11,16,17],achiev:14,across:[11,15],activ:[2,11,16],actual:14,add:[14,17],add_1:14,add_2:14,addit:[1,14,15],addition:[5,6],after:[14,15],ahead:14,aim:12,all:[1,7,10,14,15],allclos:[2,4,5,6,7,10,11,14,15,16,17],allow:[12,14],along:[11,14],alreadi:14,also:[1,7,10,11,14,16],altern:14,ani:[8,11,15,17],annoi:16,anoth:[14,16],aot:12,aot_fn:14,aot_funct:14,aot_nnc_fn:14,aot_print_fn:14,aot_recomp:14,aot_recompute_nnc_fn:14,api:[4,5,7,11,12,14,16],appear:11,append:14,appli:[8,9,10,15,16],approach:11,arbitrari:[15,17],architectur:15,arg:[1,4,5,6,11,14,15],argnum:[2,3,4,5,6,16],argument:[2,3,4,5,6,7,10,11,16,17],around:[15,16,17],arrai:[5,6],assert:[0,1,2,4,5,6,7,10,11,14,15,16,17],assist:14,aten:14,atol:[15,17],author:11,autobatch:11,autodiff:[5,6,7,16],autograd:[11,12,16,17],aux:[2,3,5,6,7,10],auxiliari:[2,3,5,6,7,10],avg_bw_lat:14,avg_fw_lat:14,awar:14,back:14,backend:14,backward:[14,17],bandwidth:14,base:14,basic:[4,5,6],batch:[5,6,11,12,17],batch_hess:16,batch_jacobian0:16,batch_jacobian1:16,batch_siz:[1,2,11,16,17],batched_dot:11,batched_pow:11,becaus:[2,6,10,11,14,17],becom:16,been:16,behav:10,being:10,below:12,bench:14,benchmark:[14,15,16,17],benefit:14,best:[15,17],better:[14,16,17],bia:16,big:15,bool:[2,3,5,6,7,10],both:14,bound:14,box:11,branch:13,broadli:14,buffer:[1,8,9,15,17],bug:[4,5,7],bw_begin:14,bw_compil:14,bw_end:14,bw_latenc:14,bwd:14,calcul:14,call:[0,11,14,17],callabl:[2,3,10,14],can:[0,2,3,5,6,7,8,9,10,11,14,15,16,17],cannot:1,certain:16,characterist:16,check:[12,13,14],clear_compile_cach:14,clone:[14,16],cloned_a:14,cloned_b:14,cloned_c:14,cloned_d:14,cloned_input:14,close:14,cnn:[15,17],code:14,column:16,com:17,combin:15,combine_state_for_ensembl:15,come:[12,14],common:[15,16,17],compar:14,comparison:17,competit:17,compil:14,compiler_fn:14,compos:[2,4,5,6,11],composit:[4,16],comput:[0,2,3,4,5,6,7,10,11,12,17],compute_batch_hessian:16,compute_batch_jacobian:16,compute_grad:17,compute_jac:16,compute_loss:[2,8,9,17],compute_sample_grad:17,conceptu:17,configur:14,conjunct:14,construct:[0,11],contain:[7,10,11,14],context:[2,6,10],conv1:[15,17],conv2:[15,17],conv2d:[15,17],conveni:[15,16],cool:17,correct:14,cos:[2,5,6,10,14],cos_1:14,cos_x:2,cotang:10,coupl:15,cover:12,coverag:[4,5,7],cpu:14,creat:17,cuda:[14,15,17],curiou:[15,17],current:12,data:[1,15,16,17],dataset:[15,17],deal:16,deep:[14,16],def:[0,2,4,5,6,8,9,10,11,14,15,16,17],defin:17,demonstr:15,depend:[2,6,10,16],deriv:[7,10],design:12,detach:14,detail:14,determin:[15,17],develop:[12,13,14],devic:[14,15,17],diag:[4,5,6],diagon:[5,6],dict:11,differ:[5,6,11,14,15,16],differenti:[5,6,7,10,17],difficult:[11,16],dim:[2,11,15,17],dimens:[1,11,15,17],din:16,directli:[1,16],discuss:14,doc:11,doe:[11,14,16],doesn:11,done:15,dot:[2,11],dout:16,dummi:[15,16,17],dure:14,each:[1,2,3,7,10,11,12,15,16,17],eager:[12,14],earlier:14,easi:16,easiest:16,effect:[11,14,15,17],effici:[12,16,17],element:[2,3,5,6,7,10,11],elimin:[15,16],enabl:14,end:14,engin:11,ensembl:[1,12],entir:17,equal:[2,3],equival:17,error:[4,5,7,11],evalu:7,even:[10,16],everi:17,exampl:[0,1,2,3,8,9,11,14,15,16,17],except:[11,15,16,17],exist:14,expect:[5,6,16],expectedi:[5,6],expectedx:[5,6],experi:[11,14],express:12,extra:11,extract:[8,9,14],eye:[11,16],facilit:14,fairest:17,fals:[2,3,5,6,7,10],faster:[15,16,17],fc1:[15,17],fc2:[15,17],featur:[14,16],feature_s:[2,11],feature_vec:[2,11],fewer:[14,16],file:[4,5,7],first:[2,3,5,6,7,10,11,15,17],flag:[2,3,5,6,7,10],flatten:[15,17],flip:16,fmodel:[1,15,17],follow:[0,8,9,14,15,16],forward:[0,3,4,5,7,14,15,17],framework:12,friendli:14,from:[2,4,5,6,7,8,9,12,14,15,16,17],front:15,ft_compute_grad:17,ft_compute_sample_grad:17,ft_jac_bia:16,ft_jac_weight:16,ft_jacobian:16,ft_per_sample_grad:17,full:[10,11,16],func:[1,2,3,4,5,6,7,8,9,10,11],functool:[15,16,17],functorch:[14,15],furthemor:16,further:14,furthermor:15,fuse:14,fw_begin:14,fw_compil:14,fw_end:14,fw_latenc:14,fwd:14,fx_modul:14,gave:16,gener:[0,11,15,16,17],get:[4,5,6,14,15,16,17],get_vjp:11,github:[12,13,15,17],give:[4,5,6,15,16],given:[0,1,8,9,10,16,17],global:[15,16,17],goe:16,going:15,good:[4,5,7,12],gpu:[15,17],grad:[3,7,8,9,10,11,12,14,16],grad_weight:[8,9],grad_weight_per_exampl:2,gradient:[2,3,7,11,12,14,16],graph:14,graphmodul:14,greatest:13,handl:[11,15,17],hardwar:[15,16,17],has:[8,11,14,15,16],has_aux:[2,3,5,6,7,10],have:[1,11,12,14,15,16,17],haven:[15,17],hear:12,heavi:12,help:[2,11,14,16],here:[1,8,9,14,15,16,17],hess0:16,hess1:16,hess2:16,hess:4,hessian:[5,6,12],hide:11,higher:[2,11,14,16],hood:16,how:[1,12,15,17],howev:[0,5,6,10,11,14,15],http:17,i_n:11,idea:12,illustr:15,imag:[15,17],implement:[4,5,7,15,16,17],imposs:11,improv:14,in_dim:[2,11,15,16,17],in_featur:1,incur:14,inde:16,independ:16,index:[4,5,6,11],indic:[2,3,5,6,7,10,11],initi:15,inner:[2,6,10,12],input:[0,2,3,4,5,6,7,11,14,15,16,17],insid:[2,6,10],instal:12,instead:[5,6,7,8,10,11,14,16],instruct:[12,13],integ:[2,3,4,5,6],integr:14,interest:16,intermedi:14,intern:14,invok:[8,9],isol:14,issu:[12,15,17],iter:14,its:[2,3,6,10,15],itself:[5,6],jacboian:[5,6],jacfwd:4,jacobian:[0,5,6,7,10,11,12],jacobian_row:[11,16],jacrev:[0,4,5],jax:12,joint:14,just:[14,16],jvp:16,jvp_out:7,kei:14,kernel:[15,17],know:[15,17],known:7,kwarg:[1,10,11],lambda:[2,7,10,11],large_input:14,latenc:14,later:14,latest:13,lead:[11,14],learn:[16,17],len:10,length:11,let:[14,15,16,17],librari:12,lift:11,like:[0,4,9,11,12,15,16,17],limit:[15,17],linear:[0,1,2,8,9,11,15,16,17],list:[1,17],log_softmax:[15,17],look:[13,14,15,17],loop:[12,15,16,17],loss:[2,14,17],loss_fn:17,loss_per_sampl:2,lot:14,love:12,machin:[12,15,17],mai:[4,5,7,15,16,17],main:13,make:[1,8,16],make_funct:0,make_functional_with_buff:[0,8,17],maml:12,manag:[2,6,10],mani:[15,16,17],manual:17,manual_se:[15,16,17],map:[11,15,16,17],match:11,matmul:10,matrix:[11,16],max_pool2d:[15,17],mayb:15,mean:[2,14],measur:[15,16,17],mechan:14,memori:14,memory_efficient_fus:14,meta:17,method:[16,17],might:16,min_cut_rematerialization_partit:14,minibatch:[15,17],mnist:[15,17],mode:[4,5,6,7,10,12],model:[0,1,2,8,9,11,12,14,16,17],modifi:14,modul:[1,8,9,12,15,17],moment:[4,5,7],more:[2,3,4,5,6,7,10,11,14],movedim:16,mse_loss:[8,9],mseloss:2,much:[16,17],mul:14,mul_1:14,multipl:[5,6,7,10,11,15],must:[2,3,4,5,6,7,10,11,15],mutat:[15,17],my_loss_func:2,naiv:17,need:0,neg:14,neg_1:14,neg_sin_x:2,nest:[2,11],network:14,neural:14,next:17,nightli:13,nll_loss:17,nnc:14,no_grad:[2,6,10],non:16,none:[1,2,11,14,15,16,17],note:[14,15,17],notic:17,now:[14,17],num_model:[1,15,17],number:[12,14,15,16,17],nvfuser:14,object:[2,3,5,6,7,10,15,16,17],observ:14,offer:[15,16],often:14,older:[13,15,17],onc:14,one:[1,2,3,4,5,6,7,10,11,14,16,17],ones:[7,10,15,17],ones_lik:[5,6,10],onli:[15,17],opacu:17,open:[12,15,17],oper:[2,4,5,6,7,11,15,16,17],ops:14,optim:[12,15,17],option:[4,5,6,15],order:[2,11,16],origin:[14,17],other:[2,3,4,7,10,12,14,16,17],otherwis:16,our:[12,13,15,16,17],out:[2,4,5,7,11,12,13],out_dim:11,out_featur:1,outer:[2,6,10],output:[1,2,3,5,6,7,10,11,14,15,16,17],outsid:[2,6,10],over:[0,1,4,8,9,11,14,15,16,17],overhead:[14,16],own:14,pair:17,param:[1,8,9,15,17],paramet:[0,1,2,3,4,5,6,7,8,9,10,11,15,16,17],partial:[10,15,16,17],particular:[11,15,17],partition:14,partition_fn:14,pass:[0,5,6,7,10,14,15,17],per:[2,11,12,16],per_sample_grad:17,perf_count:14,perform:[4,12,14,16],place:[15,17],pleas:[4,5,7,8,12,13,14,15,17],plug:14,pointwis:[5,6,14],posit:[7,10],possibl:[4,8,15,16],post:14,predict:[15,16,17],predict_with_output_sum:16,predictions1:15,predictions1_vmap:15,predictions2:15,predictions2_vmap:15,prefer:16,prefix:14,prepar:[1,15],presenc:14,pretend:[15,17],pretti:16,prevent:14,preview:13,previous:11,primal:[3,7,10],primals_1:14,primals_2:14,primals_3:14,primals_4:14,print:[14,15,16,17],printer:14,priorit:[4,5,7],privaci:17,probabl:1,problem:16,produc:[5,6,11,15,16],product:[7,10,11,16],provid:[11,12,14,16],pure:[15,17],push:11,python:[2,3,4,5,6,7,10,11,15,17],pytorch:[2,4,5,6,7,10,11,12,13,14,15,16,17],quantiti:[12,16,17],quick:[15,17],rand:2,randint:[15,17],randn:[0,1,2,4,5,6,7,8,9,10,11,14,15,16,17],random:[11,15],rang:[1,14,15,17],rather:17,reach:12,read:14,readm:12,recommend:13,reduc:14,ref:14,refer:[12,14],regular:17,reli:14,relu:[2,11,15,17],report:[4,5,7],repres:14,requir:[11,13],requires_grad:[2,11,14],requires_grad_:[14,15,16],res:14,research:17,respect:[2,3,4,5,6,7,10,16,17],restrict:14,result:[1,2,6,10,11],retain_graph:11,revers:[4,6,10],rid:16,rigor:16,row:[11,16],rtol:[15,17],rule:[15,16,17],rummag:11,run:[1,11,12,14,15,16,17],runtim:14,rzou:16,sai:[4,5,6,15,16],same:[1,4,5,6,7,10,11,14,15,17],sampl:[2,12,16],sample_grad:17,save:14,saw:16,scale:[10,11],second:[2,5,6,7,10,11],section:12,see:[3,4,5,7,14,15,17],self:[14,15,17],semant:11,send:14,sep:14,separ:[12,15],sequenc:11,sequenti:11,set:14,setup:11,shape:[0,1,5,6,10,11,15,16,17],shard:17,should:[2,6,10,11,15,17],show:14,side:[15,17],similar:14,similarli:16,simpl:[1,2,10,11,14,15,16,17],simplecnn:[15,17],simpler:11,simpli:16,sin:[2,4,5,6,10,14],sin_1:14,singl:[2,3,11,12,16,17],size:[1,7,11,15,17],smarter:14,solut:17,some:[11,14,15,16,17],someth:0,sometim:16,sourc:[1,2,3,4,5,6,7,8,9,10,11],specif:14,specifi:[2,3,11,15],speed:[14,15],speedup:[14,17],stabl:13,stack:[1,11,15,16,17],stand:[7,10],standard:16,start:[14,16],state:[8,9,15],stateless:[15,17],statist:14,stmt:[15,16,17],str:[11,14],strategi:4,strict:7,struct:[10,11],structur:[7,11,15,17],subsitut:16,subsystem:12,suggest:[12,16],suit:14,suitabl:14,sum:[4,5,6,10,14,16],suppli:14,support:[7,10,16],sure:16,symbol:14,system:16,take:[0,2,3,4,5,6,7,10,11,16],talk:14,taller:16,tangent:7,tangents_1:14,tanh:16,tanh_backward:16,target:[2,15,17],task:12,techniqu:14,tell:15,tensor:[2,3,4,5,6,7,10,11,14,15],test:[14,15],than:[14,15,16,17],them:[14,15,16,17],thi:[2,4,5,6,7,8,10,11,12,13,14,15,16,17],think:16,those:11,though:[15,17],thread:[15,16,17],three:0,through:[4,11,14,15],thu:14,thumb:16,time:[7,10,14,16],timeit:[15,16,17],timer:[15,16,17],todai:12,todo:16,togeth:[1,2,6,10,12,15],toolkit:14,torch:[1,2,4,5,6,7,8,9,10,11,12,14,15,16,17],torchscript:14,total:17,tour:12,trace:14,tradit:16,tradition:15,train:[14,17],transform:[2,6,8,9,10,15,17],transpos:10,trick:16,tricki:12,trigger:14,ts_compil:14,tupl:[2,3,4,5,6,7,10,11],tutori:[14,16],tvm:14,two:[13,14,16],type:[14,15,17],unabl:[15,17],unari:[5,6],unbind:11,under:[12,16],underli:[15,17],understand:14,unit:16,unit_vector:16,unsqueez:17,unsuccessfulli:11,usag:[4,5,6],use:[1,8,10,11,12,15,16,17],used:[2,10,11,14,17],useful:[7,11,16,17],user:14,uses:[11,14,16],using:[2,5,6,10,11,12,15,16],using_bwd:16,using_fwd:16,usual:[11,14],util:[12,14,15,16,17],valu:[0,2,3,7,10],variabl:11,variou:16,vec:16,vector:[7,10,11,16,17],veri:[1,2,4,5,7,11],version:[1,8,9,13,15,16,17],via:[4,16],vjp:[11,12,16],vjp_fn:[10,16],vjpfunc:10,vmap:[1,2,5,6,12,16,17],wai:[0,13,16],want:[0,1,15,16],warmup:14,weight:[2,11,15,16,17],were:[11,15],weren:[15,17],what:0,when:[2,7,10,11],where:[0,5,6,7,10,11,15,17],whether:11,which:[4,5,6,7,11,14,15,16],whirlwind:12,whole:11,wider:16,wish:[7,15,17],with_vmap:[15,16,17],without:[12,15,16,17],without_vmap:[15,16,17],work:[12,13,14,15,16,17],would:[16,17],wrap:14,wrapper:14,write:[11,14],written:17,y_pred:2,y_true:2,you:[0,1,4,5,7,12,13,15,16,17],your:16,zip:[15,17]},titles:["functorch API Reference","functorch.combine_state_for_ensemble","functorch.grad","functorch.grad_and_value","functorch.hessian","functorch.jacfwd","functorch.jacrev","functorch.jvp","functorch.make_functional","functorch.make_functional_with_buffers","functorch.vjp","functorch.vmap","functorch","Install functorch","AOT Autograd - How to use and optimize?","Model ensembling","Jacobians, hessians, and more: composing functorch transforms","Per-sample-gradients"],titleterms:{"function":[0,12],Use:14,Using:15,activ:14,aka:14,aot:14,api:0,approach:16,autograd:14,background:14,batch:16,checkpoint:14,combine_state_for_ensembl:1,compar:16,compos:[12,16],comput:16,content:12,ensembl:15,forward:16,functorch:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,16,17],fusion:14,grad:[2,17],grad_and_valu:3,gradient:17,hessian:[4,16],how:14,instal:13,jacfwd:[5,16],jacobian:16,jacrev:[6,16],jvp:7,learn:14,make_funct:8,make_functional_with_buff:9,mode:16,model:15,modul:0,more:[12,16],naiv:16,oper:14,optim:14,per:17,perform:[15,17],read:12,recomput:14,refer:0,revers:16,sampl:17,setup:[14,16],torch:0,transform:[0,12,16],tutori:12,use:14,using:17,util:0,vector:15,vjp:10,vmap:[11,15],what:[14,15,17],why:12,work:0,you:14}})